task copyAnathemaModules(type: Copy) {
    dependsOn subprojects.assemble
    subprojects.each {
        def projectName = it.name
        if (projectName.toLowerCase().contains("anathema")) {
            return;
        }
        from "$projectName/build/libs/${projectName}.jar"
    }
    into pluginsDir
}

task copyExternalDependencies(type: Copy) {
    from {
        Set allDependencies = []
        subprojects.each { project ->
            def moduleDependencies = project.configurations.compile.findAll { File dependency ->
                def isNotJavaFx = !dependency.absolutePath.contains('jfxrt.jar')
                def isExternal = dependency.absolutePath.contains('cache')
                return isExternal && isNotJavaFx
            }
            allDependencies.addAll moduleDependencies
        }
        return allDependencies
    }
    into dependenciesDir
}