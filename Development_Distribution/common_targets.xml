<?xml version="1.0"?>
<project name="Common Targets">
	<description>Common targets and task definitions for building Anathema.
	</description>

	<import file="common_variables.xml" />

	<macrodef name="copyProjectSources">
		<attribute name="project" />
		<sequential>
			<copy todir="${dist_src}">
				<fileset dir="../@{project}/${srcDir}">
					<include name="**/*.java" />
					<exclude name="**/testing/**/*" />
					<exclude name="**/test/**/*" />
					<exclude name="**/suite/**/*" />
					<exclude name="**/demo/**/*" />
				</fileset>
			</copy>
		</sequential>
	</macrodef>

	<macrodef name="copyProjectResources">
		<attribute name="project" />
		<attribute name="subdirectory" />
		<sequential>
			<copy todir="${dist}/@{subdirectory}">
				<fileset dir="../@{project}">
					<include name="${resourceDir}/**/*" />
					<exclude name="**/*.xcf" />
					<exclude name="**/*.svg" />
					<exclude name="**/Thumbs.db" />
				</fileset>
			</copy>
		</sequential>
	</macrodef>

	<macrodef name="copyProjectFiles">
		<attribute name="project" />
		<attribute name="subdirectory" />
		<sequential>
			<copyProjectSources project="@{project}" />
			<copyProjectResources project="@{project}" subdirectory="@{subdirectory}" />
		</sequential>
	</macrodef>

	<target name="Add License To Sources" description="Add license info to source files">
		<for param="file">
			<path>
				<fileset dir="${dist_src}">
					<include name="**/*.java" />
				</fileset>
			</path>
			<sequential>
				<concat destfile="${dist}/temp">
					<header>/*Anathema (C) 2004-2006 by Sandra Sieroux and Urs Reupke. Published under the GNU GPL. See license.txt for details.*/
					</header>
					<fileset file="@{file}" />
				</concat>
				<move file="${dist}/temp" tofile="@{file}" />
			</sequential>
		</for>
	</target>

	<target name="Clean">
		<delete dir="${dist}" />
	</target>

	<target name="Prepare" depends="Clean" description="Create directory structure">
		<mkdir dir="${dist}" />
		<mkdir dir="${dist_lib}" />
		<mkdir dir="${dist_src}" />
		<mkdir dir="${dist_class}" />
		<mkdir dir="${dist_misc}" />
		<mkdir dir="${dist_data}" />
	</target>
</project>