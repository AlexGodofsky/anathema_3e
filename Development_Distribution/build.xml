<?xml version="1.0"?>
<project name="anathema" default="cleanDist">
	<description>This is the main build file for Anathema.
	</description>

	<import file="common_targets.xml" />
	<import file="common_variables.xml" />
	<import file="copy_core.xml" />
	<import file="build_core.xml" />
	<import file="build_music.xml" />

	<target name="dist_upgrade" depends="Prepare, Build Core JAR, copyText, copyExtras, copyNatureExample,copyModulesInstructions" description="Build the binary archive">
		<zip destfile="anathema_upgrade_v${version}.zip">
			<fileset dir="${dist}" includes="anathema.jar" />
			<fileset dir="${dist_misc}" includes="*.*" />
			<zipfileset dir="${dist_data}/" prefix="data" includes="*" />
			<zipfileset dir="${dist_modules}/" prefix="modules" includes="*" />
			<zipfileset dir="${dist_misc_spanish}/" prefix="doc/spanish" includes="*" />
		</zip>
	</target>

	<target name="dist_user" depends="Build Core JAR, Build Music JAR, copyText, copyExtras, copyNatureExample,copyModulesInstructions" description="Build out-of-the-box archive">
		<zip destfile="anathema_user_v${version}.zip">
			<fileset dir="${dist}" includes="anathema.jar" />
			<fileset dir="${dist_misc}" includes="*.*" />
			<zipfileset dir="${dist_lib}/core" prefix="lib" includes="*" />
			<zipfileset dir="${dist_data}/" prefix="data" includes="*" />
			<zipfileset dir="${dist_modules}/" prefix="modules" includes="*" />
			<zipfileset dir="${dist_misc_spanish}/" prefix="doc/spanish" includes="*" />
		</zip>
		<zip destfile="anathema_music_v${version}.zip">
			<zipfileset dir="${dist}" prefix="${modulesDir}" includes="music.jar" />
			<zipfileset dir="${dist_lib}/music" prefix="${modulesDir}/lib" includes="*" />
		</zip>
	</target>


	<target name="dist_developer" depends="Prepare, Build Core JAR, Build Music JAR, copyText, copyExtras, Add License To Sources, copyNatureExample,copyModulesInstructions" description="Build out-of-the-box archive with sources">
		<zip destfile="anathema_developer_v${version}.zip">
			<fileset dir="${dist}" includes="anathema.jar" />
			<fileset dir="${dist_misc}" includes="*.*" />
			<zipfileset dir="${dist_src}" prefix="src" includes="**/*.java" />
			<zipfileset dir="${dist_lib}/core" prefix="lib" includes="*" />
			<zipfileset dir="${dist_data}/" prefix="data" includes="*" />
			<zipfileset dir="${dist_modules}/" prefix="modules" includes="*" />
			<zipfileset dir="${dist_misc_spanish}/" prefix="doc/spanish" includes="*" />
		</zip>
	</target>

	<target name="patch_user" depends="Prepare, Copy Thirdparty, Build Core JAR, copyText, copyExtras, copyNatureExample,copyModulesInstructions" description="Build out-of-the-box archive">
		<zip destfile="anathema_user_patch_v${version}.zip">
			<fileset dir="${dist}" includes="anathema.jar" />
			<fileset dir="${dist_misc}" includes="*.*" />
			<zipfileset dir="${dist_data}/" prefix="data" includes="*" />
			<zipfileset dir="${dist_modules}/" prefix="modules" includes="*" />
			<zipfileset dir="${dist_misc_spanish}/" prefix="doc/spanish" includes="*" />
		</zip>
	</target>

	<target name="patch_developer" depends="Prepare, Copy Thirdparty, Build Core JAR, copyText, copyExtras, Add License To Sources, copyNatureExample,copyModulesInstructions" description="Build out-of-the-box archive with sources">
		<zip destfile="anathema_developer_patch_v${version}.zip">
			<fileset dir="${dist}" includes="anathema.jar" />
			<fileset dir="${dist_misc}" includes="*.*" />
			<zipfileset dir="${dist_src}" prefix="src" includes="**/*.java" />
			<zipfileset dir="${dist_data}/" prefix="data" includes="*" />
			<zipfileset dir="${dist_modules}/" prefix="modules" includes="*" />
			<zipfileset dir="${dist_misc_spanish}/" prefix="doc/spanish" includes="*" />
		</zip>
	</target>

	<target name="cleanDist" depends="Clean, dist_user, dist_developer" />

	<target name="cleanPatch" depends="Clean, patch_user, patch_developer" />

	<target name="upload">
		<ftp password="urskr@users.sourceforge.net" server="upload.sourceforge.net" userid="anonymous" remotedir="incoming" action="put">
			<fileset dir="${dist}" includes="*.zip*" />
		</ftp>
	</target>
</project>